#define FILE_NO 0x2
// SIZE is computed as follows:
// SIZE = 8192 (drsyscall_iterate_records() buffer size) -
//        10 (number of syscall records for write) * 18 (syscall record size)
// so that the last write syscall record ends exactly at the end of the buffer.
// There are ten syscall records for write: one DRSYS_SYSCALL_NUMBER_TIMESTAMP record,
// three DRSYS_PRECALL_PARAM records, one DRSYS_MEMORY_CONTENT record, three
// DRSYS_POSTCALL_PARAM records, one DRSYS_RETURN_VALUE record, and one
// DRSYS_RECORD_END_TIMESTAMP record.
#define SIZE 0x1f4c
#if defined(X86) && defined(X64)
#    define SYSCALL_WRITE 1
#    define SYSCALL_EXIT_GROUP 231
#elif defined(AARCH64)
#    define SYSCALL_WRITE 64
#    define SYSCALL_EXIT_GROUP 94
#else
#    error Unsupported architecture
#endif
.*
syscall: SYSCALL_WRITE, timestamp: [0-9]+
pre-syscall ordinal 0, value FILE_NO
pre-syscall ordinal 1, value 0x[0-9a-f]+
pre-syscall ordinal 2, value SIZE
memory content address 0x[0-9a-f]+, size SIZE
(\n|.)*30303030 30303030 3030300a( )
post-syscall ordinal 0, value FILE_NO
post-syscall ordinal 1, value 0x[0-9a-f]+
post-syscall ordinal 2, value SIZE
return value SIZE
syscall end: SYSCALL_WRITE, timestamp: [0-9]+
syscall: SYSCALL_EXIT_GROUP, timestamp: [0-9]+
pre-syscall ordinal 0, value 0x0
